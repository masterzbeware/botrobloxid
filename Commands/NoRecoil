return {
  Execute = function(tab)
      local vars = _G.BotVars or {}
      local Tabs = vars.Tabs or {}
      local CombatTab = tab or Tabs.Combat

      if not CombatTab then
          warn("[AntiRecoil] Tab Combat tidak ditemukan!")
          return
      end

      local Group = CombatTab:AddLeftGroupbox("Anti Recoil (M4A1)")

      vars.AntiRecoil = vars.AntiRecoil or false

      local Players = game:GetService("Players")
      local player = Players.LocalPlayer
      local camera = workspace.CurrentCamera
      local ReplicatedFirst = game:GetService("ReplicatedFirst")

      local BulletService = ReplicatedFirst:FindFirstChild("Actor") and ReplicatedFirst.Actor:FindFirstChild("BulletServiceMultithread")
      local BulletEvent = ReplicatedFirst:FindFirstChild("BulletEvent")

      Group:AddToggle("ToggleAntiRecoil", {
          Text = "Anti Recoil",
          Default = vars.AntiRecoil,
          Callback = function(v)
              vars.AntiRecoil = v
          end
      })

      -- Metamethod hook
      if not getgenv().AntiRecoilHooked then
          getgenv().AntiRecoilHooked = true

          local oldNamecall
          oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
              local method = getnamecallmethod()
              local args = {...}

              if vars.AntiRecoil and method == "Fire" and (self == BulletService.Send or self == BulletEvent) then
                  -- Tangkap tipe argument dan ubah OriginCFrame / arah tembakan
                  local cam = workspace.CurrentCamera

                  -- Jika argumen adalah struktur bullet (OriginCFrame)
                  if typeof(args[3]) == "table" and args[3].OriginCFrame then
                      local origin = args[3].OriginCFrame
                      args[3].OriginCFrame = CFrame.new(origin.Position, origin.Position + cam.CFrame.LookVector)
                      return oldNamecall(self, unpack(args))
                  end

                  -- Jika argumen adalah posisi Vector3 (tembakan langsung)
                  if typeof(args[2]) == "Vector3" and typeof(args[3]) == "Vector3" then
                      local pos1, pos2 = args[2], args[3]
                      local newPos2 = pos1 + (cam.CFrame.LookVector * (pos1 - pos2).Magnitude)
                      args[3] = newPos2
                      return oldNamecall(self, unpack(args))
                  end
              end

              return oldNamecall(self, ...)
          end)

          print("✅ [Anti Recoil] Hook metamethod aktif.")
      end

      print("✅ [Anti Recoil] Sistem aktif. Recoil kamera dan arah peluru distabilkan.")
  end
}
